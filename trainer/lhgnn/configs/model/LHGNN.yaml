# configs/LHGNN.yaml
_target_: trainer.lhgnn.models.tagging_module.TaggingModule

optimizer:
  _target_: torch.optim.Adam
  _partial_: true
  lr: 1e-3
  weight_decay: 5e-7
  eps: 1e-8
  betas: [0.95, 0.999]

scheduler:
  _target_: torch.optim.lr_scheduler.MultiStepLR
  _partial_: true
  milestones: [10,15,20,25,30,35,40]
  gamma: 0.5

#scheduler:
#  _target_: torch.optim.lr_scheduler.CosineAnnealingWarmRestarts
 
net:
  _target_: trainer.lhgnn.models.components.LHGNN.LHGNN
  # æ¿€æ´»å‡½æ•°ç±»å‹ï¼ˆ'relu' | 'gelu' | 'leakyrelu' | 'prelu'ç­‰ï¼‰
  act: 'gelu'
  # å½’ä¸€åŒ–å±‚ç±»å‹ï¼Œå¦‚'batch','instance'ç­‰ã€‚
  norm: 'batch'
  # æ˜¯å¦åœ¨å·ç§¯å±‚ä¸­ä½¿ç”¨åç½®ã€‚
  bias: True
  # ä¸¢å¼ƒç‡ï¼Œç”¨äºé¢„æµ‹å±‚ä¸­çš„Dropoutã€‚
  dropout: 0.0
  # é€‰æ‹©Kä¸ªæœ€è¿‘é‚»ï¼šDenseDilatedKnnGraph.xy_dense_knn_matrix
  k: 9
  # ä½œç”¨: æ˜¯å¦åœ¨å›¾å·ç§¯ä¸­ä½¿ç”¨è†¨èƒ€é‡‡æ ·,æ•ˆæœ: å¢åŠ æ„Ÿå—é‡è€Œä¸å¢åŠ å‚æ•°
  dilation: True
  # ç”¨äºDenseDilatedKnnGraphä¸­çš„éšæœºæ€§ï¼Œæ§åˆ¶éšæœºé€‰æ‹©é‚»å±…çš„æ¦‚ç‡
  epsilon: 0.2
  # DropPathçš„ä¸¢å¼ƒç‡ï¼Œç”¨äºéšæœºæ·±åº¦ã€‚
  drop_path: 0.1
  # æ¨¡å‹è§„æ¨¡
  size: 's'
  # åˆ†ç±»æ•°
  num_class: 10
  # å°å‹æ¨¡å‹ (å‚æ•°å°‘ï¼Œè®¡ç®—èµ„æºæœ‰é™)ï¼š512ã€ ä¸­å‹æ¨¡å‹ (å¹³è¡¡æ€§èƒ½ä¸è®¡ç®—)ï¼š1024ã€å¤§å‹æ¨¡å‹ (è¿½æ±‚æœ€ä½³æ€§èƒ½)ï¼š2048
  emb_dims: 1024
  # é¢‘åŸŸè½´ç»´åº¦ï¼šnum_mels 64ã€80ã€128
  freq_num: 128
  # æ—¶é—´è½´ç»´åº¦ï¼š0.5 ~ 1 ç§’ï¼š128 / 256 ã€1 ~ 2 ç§’ï¼š256 / 512 ã€2 ~ 4 ç§’ï¼š512 / 1024  ã€ >4 ç§’ï¼š1024â€“2048
  time_num: 256
  # ------------------------------  æ¨¡ç³ŠCå‡å€¼(FCM)èšç±»ç®—æ³• --------------------------------------------
  # ä¼ ç»ŸK-meansï¼šç¡¬åˆ†é…ï¼Œæ¯ä¸ªç‚¹å±äºä¸€ä¸ªç°‡,
  # ğŸ¯ æ¨¡ç³Šèšç±»ï¼šè½¯åˆ†é…ï¼Œæ¯ä¸ªç‚¹ä»¥ä¸åŒç¨‹åº¦å±äºå¤šä¸ªç°‡
  # 1. æ¨¡ç³Šèšç±»åœ¨LHGNNæ¨¡å‹ä¸­çš„æ ¸å¿ƒä½ç½®æ˜¯ï¼štorch_edge.py ä¸­çš„ HyperedgeConstruction ç±»
  # 2. è¢« LHGConv2d å’Œ MRConv2d å›¾å·ç§¯è°ƒç”¨
  # 3. ç”¨äºæ„å»ºè¶…å›¾ç»“æ„ï¼Œå¢å¼ºæ¨¡å‹çš„å…¨å±€å…³ç³»å»ºæ¨¡èƒ½åŠ›
  # 4. åŒæ—¶æ•æ‰"å±€éƒ¨ç»†èŠ‚"ï¼ˆé€šè¿‡KNNï¼‰å’Œ"å…¨å±€ç»“æ„"ï¼ˆé€šè¿‡æ¨¡ç³Šèšç±»ï¼‰
  # è¶…å›¾èšç±»ä¸­å¿ƒæ•°é‡
  clusters: 10
  # ä»èšç±»ä¸­å¿ƒé€‰æ‹©çš„top-kæ¯”ä¾‹
  cluster_ratio: 0.4
  # é€‰æ‹©å›¾å·ç§¯ç±»å‹ï¼ˆ'mr': Max-Relativeå›¾å·ç§¯ | 'lhg': è¶…å›¾å·ç§¯ï¼ˆä½¿ç”¨èšç±»ä¸­å¿ƒï¼‰ | 'edge': è¾¹å·ç§¯ | 'sage': GraphSAGEå·ç§¯ | 'gin': å›¾åŒæ„ç½‘ç»œå·ç§¯ ï¼‰
  conv: 'lhg'
  #k_dpc: 9
  #cluster_method: 'soft-kmeans'
  #refine_cluster: 'atnncheck'
  #centroid_ratio: [0.25,0.25,0.25,0.25]
  #conv: 'hypergraph'
  #ffn: 'convffn'
  #pooling_window: [8,4,2,1]
  #reduce_ratio: [4,2,1,1]
  #k_dpc: 9
  #cluster_method: 'dpc'
  #refine_cluster: true
  #num_centroids: 100
  #conv: 'hypergraph'
  #ffn: 'ffn' #convffn

# compile model for faster training with pytorch 2.0
compile: false
loss: 'bcelogit'
opt_warmup: True 
learning_rate: 1e-3
lr_rate:  [0.05, 0.02, 0.01,0.005,0.002,0.001,0.0005,0.0002]
lr_scheduler_epoch: [10,15,20,25,30,35,50,45]

